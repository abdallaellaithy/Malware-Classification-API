import requests
import pandas as pd

# Load your dataset
df = pd.read_csv("test.csv")
sample_data = df.head(5)

sample_features = sample_data.drop(columns=['Unnamed: 0', '0', 'Label'])
sample_features.fillna(0, inplace=True)

# Define the URL of the API endpoint
url = 'http://localhost:8000/predict'

# Convert the sample features to a list of lists
sample_features_list = sample_features.values.tolist()

# Send a POST request to the API endpoint
response = requests.post(url, json={'features': sample_features_list})

# Check if the request was successful
if response.status_code == 200:
    # Get the prediction from the response
    prediction = response.json()['prediction']
    print("Predicted label:", prediction)
else:
    print("Error:", response.text)
